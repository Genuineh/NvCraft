# NvCraft 架构设计

## 概述

NvCraft 采用高度模块化的架构设计,旨在提供灵活、可扩展、易维护的 Neovim 配置系统。

## 设计原则

1. **模块化优先**: 每个功能独立成模块，松耦合设计
2. **性能至上**: 懒加载、异步处理、智能缓存
3. **用户友好**: 可视化管理、智能推荐、简单配置
4. **开发者友好**: 清晰的 API、完善的文档、丰富的示例
5. **可扩展性**: 易于添加新模块和自定义功能
6. **向后兼容**: 平滑升级路径和配置迁移工具

---

## 系统架构

### 整体架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                          NvCraft 系统                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                    用户界面层 (UI Layer)                   │ │
│  ├───────────────────────────────────────────────────────────┤ │
│  │  • 模块管理器    • 配置编辑器    • 仪表盘                 │ │
│  │  • 健康检查面板  • 配置向导      • 主题管理               │ │
│  └───────────────────────────────────────────────────────────┘ │
│                            ↕                                    │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                    智能层 (Smart Layer)                    │ │
│  ├───────────────────────────────────────────────────────────┤ │
│  │  • 自动检测      • 智能推荐      • 上下文管理             │ │
│  │  • 性能优化      • 自适应配置    • 使用分析               │ │
│  └───────────────────────────────────────────────────────────┘ │
│                            ↕                                    │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                  核心系统层 (Core Layer)                   │ │
│  ├───────────────────────────────────────────────────────────┤ │
│  │  • 模块注册中心  • 模块加载器    • 事件总线               │ │
│  │  • 配置管理器    • 元数据系统    • 生命周期管理           │ │
│  └───────────────────────────────────────────────────────────┘ │
│                            ↕                                    │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                   模块层 (Module Layer)                    │ │
│  ├───────────────────────────────────────────────────────────┤ │
│  │  基础  编辑器  LSP  UI  文件  Git  工具  AI  专用         │ │
│  └───────────────────────────────────────────────────────────┘ │
│                            ↕                                    │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                  插件层 (Plugin Layer)                     │ │
│  ├───────────────────────────────────────────────────────────┤ │
│  │              lazy.nvim + 各种 Neovim 插件                  │ │
│  └───────────────────────────────────────────────────────────┘ │
│                            ↕                                    │
│  ┌───────────────────────────────────────────────────────────┐ │
│  │                   基础层 (Base Layer)                      │ │
│  ├───────────────────────────────────────────────────────────┤ │
│  │                  Neovim + Lua Runtime                      │ │
│  └───────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

详细架构文档请参见完整的 TODO.md 文件。

---

## 核心组件

### 1. 模块系统
- 模块注册中心
- 模块加载器
- 模块元数据管理

### 2. 配置管理
- 多层级配置（全局/用户/项目）
- 配置验证和迁移
- 配置导入导出

### 3. 事件系统
- 事件发布订阅
- 异步事件处理
- 模块间通信

### 4. UI 系统
- 模块管理界面
- 配置编辑器
- 仪表盘和健康检查

### 5. 智能系统
- 自动检测和推荐
- 上下文感知
- 性能优化

更多详细信息请参见 [TODO.md](../../TODO.md)。
